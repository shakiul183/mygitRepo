<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Talqeen — Simple Demo</title>
  <style>
    :root{
      --bg:#0f172a; --card:#0b1220; --muted:#94a3b8; --accent:#60a5fa;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter, system-ui, Arial, sans-serif;
      background: linear-gradient(180deg,#071023 0%, #071028 100%);
      color:#e6eef8; display:flex; align-items:center; justify-content:center;
      min-height:100vh; padding:24px;
    }
    .card{
      width:100%; max-width:820px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px; padding:20px; box-shadow: 0 6px 30px rgba(2,6,23,0.7);
      border:1px solid rgba(255,255,255,0.03);
    }
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:20px;margin:0}
    p.lead{margin:8px 0 18px;color:var(--muted);font-size:13px}
    .hadith{
      background:var(--glass); padding:16px; border-radius:8px; line-height:1.5;
      font-size:15px; color:#eaf2ff; margin-bottom:12px; min-height:72px;
    }
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    button{
      background:transparent;border:1px solid rgba(255,255,255,0.06); color:inherit;
      padding:8px 10px;border-radius:8px;cursor:pointer;font-size:13px;
    }
    button.primary{background:linear-gradient(90deg,var(--accent),#3b82f6);border:none;color:#021028}
    .opinions{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .chip{padding:8px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-size:13px}
    .meta{font-size:13px;color:var(--muted);margin-bottom:12px}
    .save-msg{color:#86efac;font-size:13px}
    footer{font-size:12px;color:var(--muted);margin-top:12px}
    .hidden{display:none}
    pre.arabic{font-size:18px; direction:rtl; text-align:right; margin:6px 0 0; font-family: "Scheherazade", "Lateef", serif;}
  </style>
</head>
<body>
  <main class="card" role="main">
    <header>
      <div>
        <h1>Talqeen (তালক্বীন) — Demo</h1>
        <p class="lead">A tiny interactive example: view text, toggle Arabic/translation, save your view.</p>
      </div>
      <div style="text-align:right">
        <div class="chip" id="statusChip">Status: <strong id="statusVal">—</strong></div>
      </div>
    </header>

    <section aria-labelledby="hadithHeading">
      <h2 id="hadithHeading" style="font-size:14px;margin:14px 0 6px;color:var(--muted)">Hadith (short excerpt)</h2>

      <div class="hadith" id="hadithBox" tabindex="0" aria-live="polite">
        <!-- Default English translation excerpt -->
        <div id="translationTxt">
          “When one of you dies and you have covered his grave with earth, let one of you stand at his head and call him by his name... then remind him of the testimony: that there is no god but Allah and that Muhammad is His Messenger.” — (reported in some collections such as al-Tabarani).
        </div>
        <pre class="arabic hidden" id="arabicTxt">إِذَا مَاتَ أَحَدُكُمْ فَسَوَّيْتُمُ التُّرَابَ عَلَى قَبْرِهِ فَلْيَقُمْ أَحَدُكُمْ عَلَى رَأْسِ قَبْرِهِ ...</pre>
      </div>

      <div class="controls" role="toolbar" aria-label="actions">
        <button id="toggleLang">Show Arabic</button>
        <button id="copyBtn">Copy Text</button>
        <button id="openRef">Open Short Notes</button>
        <button class="primary" id="clearBtn">Clear Saved Opinion</button>
      </div>

      <div class="opinions" aria-label="opinions">
        <button class="chip" data-op="mustahab">Mark: Mustahab (recommended)</button>
        <button class="chip" data-op="weak">Mark: Weak (ضعيف)</button>
        <button class="chip" data-op="bidah">Mark: Bid'ah / Not recommended</button>
      </div>

      <div class="meta" id="metaBox">
        <div><strong>Scholarly summary:</strong> Many scholars note this report exists in al-Tabarani; its chain is considered weak by several hadith critics, and schools differ (Hanafi/Shafi‘ī — some consider it recommended; Hanbali/Maliki — more cautious).</div>
      </div>

      <div class="save-msg hidden" id="saveMsg">Your choice saved ✔︎</div>

      <details id="notes" class="hidden">
        <summary>Short references & notes</summary>
        <ul>
          <li>Found in: al-Muʿjam al-Kabīr (al-Tabarānī) — reported but with contested isnād.</li>
          <li>Many scholars classify the narration as weak (ضعيف); some accept using weak hadith for recommended acts if no contradiction with stronger evidence.</li>
          <li>Not a proof to assert doctrinal claims (e.g., that talqeen guarantees salvation).</li>
        </ul>
      </details>

      <footer>
        <small>Local preference is stored in your browser (localStorage). Expand this demo as needed.</small>
      </footer>
    </section>
  </main>

  <script>
    // Simple JS for interactivity and localStorage persistence
    (function(){
      const toggleLang = document.getElementById('toggleLang');
      const arabicTxt = document.getElementById('arabicTxt');
      const translationTxt = document.getElementById('translationTxt');
      const copyBtn = document.getElementById('copyBtn');
      const openRef = document.getElementById('openRef');
      const notes = document.getElementById('notes');
      const chips = document.querySelectorAll('[data-op]');
      const saveMsg = document.getElementById('saveMsg');
      const statusVal = document.getElementById('statusVal');
      const clearBtn = document.getElementById('clearBtn');

      const STORAGE_KEY = 'talqeen_opinion_v1';

      // initialize
      function loadState(){
        const state = localStorage.getItem(STORAGE_KEY);
        if(!state){ statusVal.textContent = 'No selection'; return; }
        try{
          const obj = JSON.parse(state);
          statusVal.textContent = obj.opinionLabel || '—';
        }catch(e){
          statusVal.textContent = 'No selection';
        }
      }
      loadState();

      toggleLang.addEventListener('click', () => {
        const showingArabic = !arabicTxt.classList.contains('hidden');
        if(showingArabic){
          arabicTxt.classList.add('hidden');
          translationTxt.classList.remove('hidden');
          toggleLang.textContent = 'Show Arabic';
        } else {
          arabicTxt.classList.remove('hidden');
          translationTxt.classList.add('hidden');
          toggleLang.textContent = 'Show Translation';
        }
      });

      copyBtn.addEventListener('click', async () => {
        const txt = (arabicTxt.classList.contains('hidden') ? translationTxt.textContent : arabicTxt.textContent);
        try{
          await navigator.clipboard.writeText(txt.trim());
          copyBtn.textContent = 'Copied ✓';
          setTimeout(()=>copyBtn.textContent = 'Copy Text', 1400);
        }catch(e){
          copyBtn.textContent = 'Copy (failed)';
          setTimeout(()=>copyBtn.textContent = 'Copy Text', 1400);
        }
      });

      openRef.addEventListener('click', ()=> {
        notes.classList.toggle('hidden');
        notes.open = !notes.open;
      });

      chips.forEach(btn => {
        btn.addEventListener('click', () => {
          const op = btn.dataset.op;
          let label = '';
          if(op === 'mustahab') label = 'Mustahab (recommended by some)';
          if(op === 'weak') label = 'Weak (ضعيف) — many critics';
          if(op === 'bidah') label = 'Bid\'ah / Not recommended';

          const payload = {
            opinion: op,
            opinionLabel: label,
            savedAt: new Date().toISOString()
          };
          localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
          statusVal.textContent = label;
          saveMsg.classList.remove('hidden');
          setTimeout(()=> saveMsg.classList.add('hidden'), 1400);
        });
      });

      clearBtn.addEventListener('click', ()=> {
        localStorage.removeItem(STORAGE_KEY);
        statusVal.textContent = 'No selection';
        saveMsg.textContent = 'Cleared ✔︎';
        saveMsg.classList.remove('hidden');
        setTimeout(()=> { saveMsg.classList.add('hidden'); saveMsg.textContent = 'Your choice saved ✔︎'; }, 1400);
      });

      // keyboard accessibility: press 't' to toggle lang
      window.addEventListener('keydown', (e) => {
        if(e.key === 't' || e.key === 'T') toggleLang.click();
      });
    })();
  </script>
</body>
</html>
